{"version":3,"sources":["webpack:///external \"lodash\"","webpack:///./src/api/index.js","webpack:///./src/apps/admin-page/index.js","webpack:///external \"jQuery\""],"names":["module","exports","lodash","apiRequest","props","ep","options","method","sendRequest","omit","defaultArgs","url","postcodexLookupObj","apiUrl","headers","restNonce","timeout","dataType","contentType","args","toLowerCase","params","data","axios","then","response","catch","error","_sessionStorage","memoize","id","varName","compiled","evaluate","interpolate","escape","variable","template","document","getElementById","innerHTML","get","key","Storage","sessionStorage","getItem","set","value","setItem","e","console","log","getJSON","JSON","parse","setJSON","stringify","$","pl","__webpack_public_path__","publicPath","jQuery","init","addEventListener","apiKeyChange","initColorPicker","wpColorPicker","debounceApiKeyChange","debounce","apiKey","input","mark","createElement","style","cssText","parentNode","insertBefore","nextSibling","is_valid","fontStyle","color","title","message","alert","target","trim","length"],"mappings":"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","file":"apps/admin-page/index.js","sourcesContent":["module.exports = lodash;","/**\n * Author: postcodex\n * @todo define postcodexLookupObj in php wp_localize_script()\n */\nimport axios from 'axios';\nimport memoize from 'lodash/memoize';\nimport template from 'lodash/template';\nimport isNull from 'lodash/isNull';\nimport omit from 'lodash/omit';\n\nexport const apiRequest = ( props = {} ) => {\n\tconst { ep, options, method } = props;\n\n\treturn sendRequest( ep, omit( props, ['ep', 'options', 'method'] ), method || 'POST', options || {} );\n};\n\nexport const sendRequest = ( ep, props = null, method = 'POST', options = {} ) => {\n\tconst defaultArgs = {\n\t\turl         : `${ postcodexLookupObj.apiUrl }${ ep }`,\n\t\tmethod      : method || 'POST',\n\t\theaders     : { 'X-WP-Nonce' : postcodexLookupObj.restNonce },\n\t\ttimeout     : 30000,\n\t\tdataType    : 'json',\n\t\tcontentType : 'application/json',\n\t};\n\n\tconst args = ( 'get' === method.toLowerCase() )\n\t             ? { ...defaultArgs, params : props, ...options }\n\t             : { ...defaultArgs, data : props, ...options };\n\n\treturn axios( args )\n\t\t.then(\n\t\t\tresponse => {\n\t\t\t\treturn response;\n\t\t\t}\n\t\t)\n\t\t.catch(\n\t\t\terror => {\n\t\t\t\treturn ( { error } );\n\t\t\t}\n\t\t);\n};\n\n/**\n * Usage:\n * Somewhere on the page you have the following markup:\n * <script id=\"tmpl-my-template\" type=\"text/html\">\n *     <div class=\"some-class\">\n *         {{ jsVariableNameObject.whatever }}\n *     </div>\n * </script>\n *\n * // then on your component file:\n *\n * // Load the template\n * const myTemplate = _template( 'my-template', 'jsVariableNameObject' );\n *\n * // Output the template passing the variable for output. Example variable object:\n * const someObjectInAppToBeDisplayed = {\n *     whatever : 'Sample Text'\n * };\n * myTemplate( someObjectInAppToBeDisplayed );\n */\nexport const _template = memoize( function ( id, varName ) {\n\tconst variable = varName || 'data';\n\tlet compiled,\n\t    options = {\n\t\t    evaluate    : /<#([\\s\\S]+?)#>/g,\n\t\t    interpolate : /\\{\\{\\{([\\s\\S]+?)\\}\\}\\}/g,\n\t\t    escape      : /\\{\\{([^\\}]+?)\\}\\}(?!\\})/g,\n\t\t    variable    : variable\n\t    };\n\n\treturn function ( data ) {\n\t\tcompiled = compiled || template( document.getElementById( `tmpl-${ id }` ).innerHTML, options );\n\t\treturn compiled( data );\n\t};\n} );\n\n/**\n * Create EventSource object\n * @param url\n * @returns object\n */\nexport const createSource = ( url ) => {\n\tconst source = new EventSource( url );\n\tlet deferred;\n\n\tsource.onmessage = ( event ) => {\n\t\tconst json = JSON.parse( event.data );\n\n\t\tif ( deferred ) {\n\t\t\tdeferred.resolve( json );\n\t\t\tdeferred = null;\n\t\t}\n\t};\n\n\tsource.onopen = ( event ) => {\n\t\tconsole.log( 'eventsource open' );\n\t};\n\n\tsource.onerror = ( event ) => {\n\t\tconst source = event.target;\n\t\tconsole.log( 'eventsource error', event );\n\t\t//source.close();\n\t};\n\n\treturn {\n\t\tnextMessage() {\n\t\t\tif ( !deferred ) {\n\t\t\t\tdeferred = {};\n\t\t\t\tdeferred.promise = new Promise( ( resolve ) => deferred.resolve = resolve );\n\t\t\t}\n\n\t\t\treturn deferred.promise;\n\t\t},\n\t\tsource\n\t};\n};\n\nexport const _localStorage = {\n\tgetItem : ( key ) => {\n\t\tif ( typeof Storage !== 'undefined' ) {\n\t\t\treturn localStorage.getItem( key );\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tsetItem : ( key, value ) => {\n\t\tif ( typeof Storage !== 'undefined' ) {\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem( key, value );\n\t\t\t} catch ( e ) {\n\t\t\t\tconsole.log( e );\n\t\t\t}\n\t\t}\n\t},\n\n\tgetJSON : ( key ) => {\n\t\tif ( typeof Storage !== 'undefined' ) {\n\t\t\treturn JSON.parse( localStorage.getItem( key ) );\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tsetJSON : ( key, value ) => {\n\t\tif ( typeof Storage !== 'undefined' ) {\n\t\t\ttry {\n\t\t\t\tlocalStorage.setItem( key, JSON.stringify( value ) );\n\t\t\t} catch ( e ) {\n\t\t\t\tconsole.log( e );\n\t\t\t}\n\t\t}\n\t},\n};\n\nexport const _sessionStorage = {\n\tget : ( key ) => {\n\t\tif ( typeof Storage !== 'undefined' ) {\n\t\t\treturn sessionStorage.getItem( key );\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tset : ( key, value ) => {\n\t\tif ( typeof Storage !== 'undefined' ) {\n\t\t\ttry {\n\t\t\t\tsessionStorage.setItem( key, value );\n\t\t\t} catch ( e ) {\n\t\t\t\tconsole.log( e );\n\t\t\t}\n\t\t}\n\t},\n\n\tgetJSON : ( key ) => {\n\t\tif ( typeof Storage !== 'undefined' ) {\n\t\t\treturn JSON.parse( sessionStorage.getItem( key ) );\n\t\t}\n\n\t\treturn null;\n\t},\n\n\tsetJSON : ( key, value ) => {\n\t\tif ( typeof Storage !== 'undefined' ) {\n\t\t\ttry {\n\t\t\t\tsessionStorage.setItem( key, JSON.stringify( value ) );\n\t\t\t} catch ( e ) {\n\t\t\t\tconsole.log( e );\n\t\t\t}\n\t\t}\n\t},\n};\n\n/**\n * Usage:\n * hashCode( data ).then( hash => { ...do something with `hash` } );\n *\n * @param message\n * @param maxChars\n * @returns {Promise<string>}\n */\nexport const hashCode = async ( message, maxChars = 8 ) => {\n\tlet code = '';\n\tif ( 'undefined' !== typeof crypto && 'undefined' !== typeof crypto.subtle && 'undefined' !== typeof crypto.subtle.digest ) {\n\t\tconst msgUint8   = new TextEncoder().encode( JSON.stringify( message ) ),\n\t\t      hashBuffer = await crypto.subtle.digest( 'SHA-256', msgUint8 ),\n\t\t      hashArray  = Array.from( new Uint8Array( hashBuffer ) );\n\n\t\tcode = hashArray.map( b => b.toString( 16 ).padStart( 2, '0' ) ).join( '' );\n\t} else {\n\t\tcode = md5( JSON.stringify( message ) );\n\t}\n\n\tif ( isNull( maxChars ) && maxChars !== code.length ) {\n\t\treturn code;\n\t}\n\n\treturn code.substr( 0, maxChars );\n};\n","/**\n * Author: postcodex\n * Date: 10/13/20\n * Time: 10:08 PM\n */\n__webpack_public_path__ = `${ postcodexLookupObj.publicPath }/`;\nimport { debounce } from 'lodash';\nimport { apiRequest } from '../../api';\nimport style from './style.scss';\n\n( function ( $ ) {\n\t'use strict';\n\n\tconst pl = {\n\t\tinit : () => {\n\t\t\tdocument.getElementById( 'api_key' ).addEventListener( 'keyup', pl.apiKeyChange );\n\n\t\t\tpl.initColorPicker();\n\t\t},\n\n\t\tinitColorPicker : () => {\n\t\t\t$( '.pl-color-picker' ).wpColorPicker();\n\t\t},\n\n\t\tdebounceApiKeyChange : debounce( ( apiKey ) => {\n\t\t\tconst input = document.getElementById( 'api_key' );\n\t\t\tlet mark = document.getElementById( 'api-key-validity' );\n\t\t\tif ( !mark ) {\n\t\t\t\tmark = document.createElement( 'span' );\n\t\t\t}\n\t\t\tmark.id = 'api-key-validity';\n\t\t\tmark.style.cssText = 'display: inline-block; vertical-align: middle; margin: 0.4em; font-style: italic;';\n\t\t\tmark.innerHTML = 'verifying...';\n\t\t\tinput.parentNode.insertBefore( mark, input.nextSibling );\n\n\t\t\tapiRequest( {\n\t\t\t\tep     : 'validate-api-token',\n\t\t\t\tmethod : 'GET',\n\t\t\t\tapiKey\n\t\t\t} ).then( ( { data, error } ) => {\n\t\t\t\tif ( data ) {\n\t\t\t\t\tconst { is_valid } = data;\n\n\t\t\t\t\tmark.style.fontStyle = 'normal';\n\t\t\t\t\tif ( is_valid ) {\n\t\t\t\t\t\tmark.innerHTML = '&#10004;';\n\t\t\t\t\t\tmark.style.color = 'green';\n\t\t\t\t\t\tmark.title = 'API key is valid.';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmark.innerHTML = '&#10006;';\n\t\t\t\t\t\tmark.style.color = 'red';\n\t\t\t\t\t\tmark.title = 'API key is invalid.';\n\t\t\t\t\t}\n\t\t\t\t\tinput.parentNode.insertBefore( mark, input.nextSibling );\n\t\t\t\t} else {\n\t\t\t\t\tconst { message } = error;\n\t\t\t\t\talert( message );\n\t\t\t\t}\n\t\t\t} );\n\t\t}, 700 ),\n\n\t\tapiKeyChange : ( e ) => {\n\t\t\tif ( 2 < e.target.value.trim().length ) {\n\t\t\t\tpl.debounceApiKeyChange( e.target.value );\n\t\t\t}\n\t\t},\n\t};\n\n\tpl.init();\n} )( jQuery );\n","module.exports = jQuery;"],"sourceRoot":""}